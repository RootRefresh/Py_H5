<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <title>Summernote</title>
  <link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
  <script src="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script>
  <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.7/summernote.css" rel="stylesheet">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.7/summernote.js"></script>
</head>
<body>
  <div id="summernote"><p>Hello Summernote</p></div>
  <div class="col-sm-offset-1 col-md-offset-1  col-lg-offset-1">
      <button type="button" class="btn btn-large btn-primary submit">发布文章</button>
  </div>

  <script>
    $(document).ready(function() {

        var $summernote = $('#summernote').summernote({
            height: 300,
            minHeight: null,
            maxHeight: null,
            focus: true,
            //调用图片上传
            callbacks: {
                onImageUpload: function (files) {
                    sendFile($summernote, files[0]);
                }
            }
        });

        //ajax上传图片
        function sendFile($summernote, file) {
            var formData = new FormData();
            formData.append("file", file);
            $.ajax({
                url: "",//{:U('Upload/upload_img')} 路径是你控制器中上传图片的方法，下面controller里面我会写到
                data: formData,
                cache: false,
                contentType: false,
                processData: false,
                type: 'POST',
                success: function (data) {
                    $summernote.summernote('insertImage', data, function ($image) {
                        $image.attr('src', data);
                    });
                }
            });
        }

//         function postImage(data) {
//             $.ajax({
//                 data:data,
//                 type:"POST",
//                 url:"",
//                 contentType:"json",
//                 cache:false,
//                 processData:false,
//                 success:function (rData) {
//                     alert(rData);
//                     $('#summernote').summernote('editor.insertImage',"http://res.cloudinary.com/demo/image/upload/butterfly.jpg");
//                     alert("success");
//
//                 },
//                 error:function () {
//                     alert("error");
//                 }
//             })
//         }
//
//         function sendFile(file, editor, $editable){
//             var fileName = false;
//             try{
//                 fileName = file['name'];
//                 alert(fileName);
//             }catch (e){
//                 fileName = false;
//             }
//
//             var data = new FormData();
//
//             data.append("TaskFile",file);
//
//             alert(data);
//
//             postImage(data);
//
//
//         }
//
//         $('.submit').click(function(){
//
//                  <!--var text1 = $('#summernote').summernote('code');-->
//                  <!--alert(text1);-->
//                   $('#summernote').summernote({
//                       lang:'zh-CN',
//                       focus:true,
//                       callbacks: {
//                           onImageUpload: function (files, editor, $editable) {
//                               sendFile(files[0], editor, $editable);
//                           }
//                       }
//                   });
//          });
//
//        $('#summernote').summernote();
    });
  </script>
</body>
</html>
